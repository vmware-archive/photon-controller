{
    "variables": {
        "version" : "{{env `VERSION`}}"
    },
    "builders":[
        {
            "type": "docker",
            "image": "vmware/photon-controller-service-base:latest",
            "export_path": "./build/photon-controller-docker-{{user `version`}}.tar"
        }
    ],
    "provisioners":[
        {
            "type": "file",
            "source": "./build/RPMS/x86_64/",
            "destination": "/tmp"
        },
        {
            "type": "shell",
            "inline": [
                        "tdnf update -y;",
                        "tdnf install -y gawk openjre openjdk sed iproute2 net-tools;",
                        "ls /tmp/*.rpm | xargs rpm -i",
                        "rm -rf /tmp/*",
                        "mkdir -p /usr/java",
                        "ln -sf /var/opt/OpenJDK* /usr/java/default;"
                      ]
        }
    ]
}
